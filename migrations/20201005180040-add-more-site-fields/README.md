# Migration `20201005180040-add-more-site-fields`

This migration has been generated by Giorgio Delgado at 10/5/2020, 2:00:40 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."posts" ADD COLUMN "site_id" text   NOT NULL 

ALTER TABLE "public"."sites" ADD COLUMN "hostname" text   NOT NULL ,
ADD COLUMN "verified" boolean   NOT NULL ,
ADD COLUMN "dns_tag" text   NOT NULL 

CREATE UNIQUE INDEX "sites.dns_tag_unique" ON "public"."sites"("dns_tag")

ALTER TABLE "public"."posts" ADD FOREIGN KEY ("site_id")REFERENCES "public"."sites"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201005173052-init..20201005180040-add-more-site-fields
--- datamodel.dml
+++ datamodel.dml
@@ -1,13 +1,14 @@
 // https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
+  output = "./src/prisma-client"
 }
 model Admin {
   @@map("admins")
@@ -23,10 +24,14 @@
 model Site {
   @@map("sites")
   id String @id @default(cuid())
+  hostname String
+  verified Boolean
+  dns_tag String @unique @default(uuid())
   admin Admin @relation(fields: [admin_id], references: [id])
   admin_id  String 
+  posts Post[]
 }
 model User {
@@ -57,8 +62,10 @@
 model Post {
   @@map("posts")
   id String @id @default(cuid())
+  site Site @relation(fields: [site_id], references: [id])
+  site_id String
   comments Comment[]
   created_at DateTime @default(now())
   updated_at DateTime @updatedAt
 }
```


